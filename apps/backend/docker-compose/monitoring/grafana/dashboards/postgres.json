{
	"annotations": { "list": [] },
	"editable": false,
	"fiscalYearStartMonth": 0,
	"graphTooltip": 1,
	"links": [
		{
			"asDropdown": false,
			"icon": "external link",
			"includeVars": true,
			"keepTime": true,
			"tags": ["flow-like"],
			"targetBlank": false,
			"title": "Flow-Like Dashboards",
			"type": "dashboards"
		}
	],
	"liveNow": false,
	"panels": [
		{
			"gridPos": { "h": 3, "w": 24, "x": 0, "y": 0 },
			"id": 1,
			"options": {
				"content": "# PostgreSQL Dashboard\nDatabase performance and health metrics",
				"mode": "markdown"
			},
			"title": "",
			"type": "text"
		},
		{
			"datasource": { "type": "prometheus", "uid": "${datasource}" },
			"fieldConfig": {
				"defaults": {
					"color": { "mode": "thresholds" },
					"mappings": [
						{
							"options": {
								"0": { "color": "red", "index": 0, "text": "DOWN" },
								"1": { "color": "green", "index": 1, "text": "UP" }
							},
							"type": "value"
						}
					],
					"thresholds": {
						"mode": "absolute",
						"steps": [
							{ "color": "red", "value": null },
							{ "color": "green", "value": 1 }
						]
					},
					"unit": "short"
				}
			},
			"gridPos": { "h": 4, "w": 4, "x": 0, "y": 3 },
			"id": 2,
			"options": {
				"colorMode": "background",
				"graphMode": "none",
				"justifyMode": "center",
				"orientation": "auto",
				"reduceOptions": {
					"calcs": ["lastNotNull"],
					"fields": "",
					"values": false
				},
				"textMode": "value"
			},
			"targets": [{ "expr": "pg_up", "legendFormat": "PostgreSQL" }],
			"title": "PostgreSQL Status",
			"type": "stat"
		},
		{
			"datasource": { "type": "prometheus", "uid": "${datasource}" },
			"fieldConfig": {
				"defaults": {
					"color": { "mode": "thresholds" },
					"mappings": [],
					"thresholds": {
						"mode": "absolute",
						"steps": [
							{ "color": "green", "value": null },
							{ "color": "yellow", "value": 80 },
							{ "color": "red", "value": 90 }
						]
					},
					"unit": "short"
				}
			},
			"gridPos": { "h": 4, "w": 5, "x": 4, "y": 3 },
			"id": 3,
			"options": {
				"colorMode": "value",
				"graphMode": "area",
				"justifyMode": "auto",
				"orientation": "auto",
				"reduceOptions": {
					"calcs": ["lastNotNull"],
					"fields": "",
					"values": false
				},
				"textMode": "auto"
			},
			"targets": [
				{ "expr": "sum(pg_stat_activity_count)", "legendFormat": "Connections" }
			],
			"title": "Active Connections",
			"type": "stat"
		},
		{
			"datasource": { "type": "prometheus", "uid": "${datasource}" },
			"fieldConfig": {
				"defaults": {
					"color": { "mode": "thresholds" },
					"mappings": [],
					"thresholds": {
						"mode": "absolute",
						"steps": [{ "color": "green", "value": null }]
					},
					"unit": "decbytes"
				}
			},
			"gridPos": { "h": 4, "w": 5, "x": 9, "y": 3 },
			"id": 4,
			"options": {
				"colorMode": "value",
				"graphMode": "area",
				"justifyMode": "auto",
				"orientation": "auto",
				"reduceOptions": {
					"calcs": ["lastNotNull"],
					"fields": "",
					"values": false
				},
				"textMode": "auto"
			},
			"targets": [
				{ "expr": "sum(pg_database_size_bytes)", "legendFormat": "Size" }
			],
			"title": "Database Size",
			"type": "stat"
		},
		{
			"datasource": { "type": "prometheus", "uid": "${datasource}" },
			"fieldConfig": {
				"defaults": {
					"color": { "mode": "thresholds" },
					"mappings": [],
					"thresholds": {
						"mode": "absolute",
						"steps": [{ "color": "green", "value": null }]
					},
					"unit": "short"
				}
			},
			"gridPos": { "h": 4, "w": 5, "x": 14, "y": 3 },
			"id": 5,
			"options": {
				"colorMode": "value",
				"graphMode": "area",
				"justifyMode": "auto",
				"orientation": "auto",
				"reduceOptions": {
					"calcs": ["lastNotNull"],
					"fields": "",
					"values": false
				},
				"textMode": "auto"
			},
			"targets": [
				{
					"expr": "sum(rate(pg_stat_database_xact_commit[5m]))",
					"legendFormat": "TPS"
				}
			],
			"title": "Transactions/sec",
			"type": "stat"
		},
		{
			"datasource": { "type": "prometheus", "uid": "${datasource}" },
			"fieldConfig": {
				"defaults": {
					"color": { "mode": "thresholds" },
					"mappings": [],
					"thresholds": {
						"mode": "absolute",
						"steps": [
							{ "color": "green", "value": null },
							{ "color": "yellow", "value": 90 },
							{ "color": "red", "value": 95 }
						]
					},
					"unit": "percent"
				}
			},
			"gridPos": { "h": 4, "w": 5, "x": 19, "y": 3 },
			"id": 6,
			"options": {
				"colorMode": "value",
				"graphMode": "area",
				"justifyMode": "auto",
				"orientation": "auto",
				"reduceOptions": {
					"calcs": ["lastNotNull"],
					"fields": "",
					"values": false
				},
				"textMode": "auto"
			},
			"targets": [
				{
					"expr": "100 * sum(pg_stat_database_blks_hit) / (sum(pg_stat_database_blks_hit) + sum(pg_stat_database_blks_read) + 0.001)",
					"legendFormat": "Hit Ratio"
				}
			],
			"title": "Cache Hit Ratio",
			"type": "stat"
		},
		{
			"datasource": { "type": "prometheus", "uid": "${datasource}" },
			"fieldConfig": {
				"defaults": {
					"color": { "mode": "palette-classic" },
					"custom": {
						"axisCenteredZero": false,
						"axisColorMode": "text",
						"axisLabel": "",
						"axisPlacement": "auto",
						"barAlignment": 0,
						"drawStyle": "line",
						"fillOpacity": 10,
						"gradientMode": "none",
						"hideFrom": { "legend": false, "tooltip": false, "viz": false },
						"lineInterpolation": "smooth",
						"lineWidth": 2,
						"pointSize": 5,
						"scaleDistribution": { "type": "linear" },
						"showPoints": "never",
						"spanNulls": false,
						"stacking": { "group": "A", "mode": "none" },
						"thresholdsStyle": { "mode": "off" }
					},
					"mappings": [],
					"thresholds": {
						"mode": "absolute",
						"steps": [{ "color": "green", "value": null }]
					},
					"unit": "short"
				}
			},
			"gridPos": { "h": 8, "w": 12, "x": 0, "y": 7 },
			"id": 7,
			"options": {
				"legend": {
					"calcs": ["mean", "max"],
					"displayMode": "table",
					"placement": "bottom"
				},
				"tooltip": { "mode": "multi", "sort": "desc" }
			},
			"targets": [
				{
					"expr": "sum(rate(pg_stat_database_xact_commit[5m]))",
					"legendFormat": "Commits"
				},
				{
					"expr": "sum(rate(pg_stat_database_xact_rollback[5m]))",
					"legendFormat": "Rollbacks"
				}
			],
			"title": "Transaction Rate",
			"type": "timeseries"
		},
		{
			"datasource": { "type": "prometheus", "uid": "${datasource}" },
			"fieldConfig": {
				"defaults": {
					"color": { "mode": "palette-classic" },
					"custom": {
						"axisCenteredZero": false,
						"axisColorMode": "text",
						"axisLabel": "",
						"axisPlacement": "auto",
						"barAlignment": 0,
						"drawStyle": "line",
						"fillOpacity": 10,
						"gradientMode": "none",
						"hideFrom": { "legend": false, "tooltip": false, "viz": false },
						"lineInterpolation": "smooth",
						"lineWidth": 2,
						"pointSize": 5,
						"scaleDistribution": { "type": "linear" },
						"showPoints": "never",
						"spanNulls": false,
						"stacking": { "group": "A", "mode": "none" },
						"thresholdsStyle": { "mode": "off" }
					},
					"mappings": [],
					"thresholds": {
						"mode": "absolute",
						"steps": [{ "color": "green", "value": null }]
					},
					"unit": "short"
				}
			},
			"gridPos": { "h": 8, "w": 12, "x": 12, "y": 7 },
			"id": 8,
			"options": {
				"legend": {
					"calcs": ["mean", "max"],
					"displayMode": "table",
					"placement": "bottom"
				},
				"tooltip": { "mode": "multi", "sort": "desc" }
			},
			"targets": [
				{
					"expr": "pg_stat_activity_count{state!=\"\"}",
					"legendFormat": "{{state}}"
				}
			],
			"title": "Connections by State",
			"type": "timeseries"
		},
		{
			"datasource": { "type": "prometheus", "uid": "${datasource}" },
			"fieldConfig": {
				"defaults": {
					"color": { "mode": "palette-classic" },
					"custom": {
						"axisCenteredZero": false,
						"axisColorMode": "text",
						"axisLabel": "",
						"axisPlacement": "auto",
						"barAlignment": 0,
						"drawStyle": "line",
						"fillOpacity": 10,
						"gradientMode": "none",
						"hideFrom": { "legend": false, "tooltip": false, "viz": false },
						"lineInterpolation": "smooth",
						"lineWidth": 2,
						"pointSize": 5,
						"scaleDistribution": { "type": "linear" },
						"showPoints": "never",
						"spanNulls": false,
						"stacking": { "group": "A", "mode": "none" },
						"thresholdsStyle": { "mode": "off" }
					},
					"mappings": [],
					"thresholds": {
						"mode": "absolute",
						"steps": [{ "color": "green", "value": null }]
					},
					"unit": "short"
				}
			},
			"gridPos": { "h": 8, "w": 12, "x": 0, "y": 15 },
			"id": 9,
			"options": {
				"legend": {
					"calcs": ["mean", "max"],
					"displayMode": "table",
					"placement": "bottom"
				},
				"tooltip": { "mode": "multi", "sort": "desc" }
			},
			"targets": [
				{
					"expr": "sum(rate(pg_stat_database_tup_fetched[5m]))",
					"legendFormat": "Fetched"
				},
				{
					"expr": "sum(rate(pg_stat_database_tup_inserted[5m]))",
					"legendFormat": "Inserted"
				},
				{
					"expr": "sum(rate(pg_stat_database_tup_updated[5m]))",
					"legendFormat": "Updated"
				},
				{
					"expr": "sum(rate(pg_stat_database_tup_deleted[5m]))",
					"legendFormat": "Deleted"
				}
			],
			"title": "Tuple Operations Rate",
			"type": "timeseries"
		},
		{
			"datasource": { "type": "prometheus", "uid": "${datasource}" },
			"fieldConfig": {
				"defaults": {
					"color": { "mode": "palette-classic" },
					"custom": {
						"axisCenteredZero": false,
						"axisColorMode": "text",
						"axisLabel": "",
						"axisPlacement": "auto",
						"barAlignment": 0,
						"drawStyle": "line",
						"fillOpacity": 10,
						"gradientMode": "none",
						"hideFrom": { "legend": false, "tooltip": false, "viz": false },
						"lineInterpolation": "smooth",
						"lineWidth": 2,
						"pointSize": 5,
						"scaleDistribution": { "type": "linear" },
						"showPoints": "never",
						"spanNulls": false,
						"stacking": { "group": "A", "mode": "none" },
						"thresholdsStyle": { "mode": "off" }
					},
					"mappings": [],
					"thresholds": {
						"mode": "absolute",
						"steps": [{ "color": "green", "value": null }]
					},
					"unit": "decbytes"
				}
			},
			"gridPos": { "h": 8, "w": 12, "x": 12, "y": 15 },
			"id": 10,
			"options": {
				"legend": {
					"calcs": ["lastNotNull"],
					"displayMode": "table",
					"placement": "bottom"
				},
				"tooltip": { "mode": "multi", "sort": "desc" }
			},
			"targets": [
				{
					"expr": "pg_database_size_bytes{datname!~\"template.*\"}",
					"legendFormat": "{{datname}}"
				}
			],
			"title": "Database Size by Database",
			"type": "timeseries"
		}
	],
	"refresh": "30s",
	"schemaVersion": 38,
	"style": "dark",
	"tags": ["flow-like", "postgresql", "database"],
	"templating": {
		"list": [
			{
				"current": {
					"selected": false,
					"text": "Prometheus",
					"value": "Prometheus"
				},
				"hide": 0,
				"includeAll": false,
				"label": "Data Source",
				"multi": false,
				"name": "datasource",
				"options": [],
				"query": "prometheus",
				"refresh": 1,
				"regex": "",
				"skipUrlSync": false,
				"type": "datasource"
			}
		]
	},
	"time": { "from": "now-1h", "to": "now" },
	"timepicker": {},
	"timezone": "browser",
	"title": "Flow-Like PostgreSQL",
	"uid": "flow-like-postgres",
	"version": 1
}
