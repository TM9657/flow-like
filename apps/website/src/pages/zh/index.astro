---
import "@tm9657/flow-like-ui/global.css";
import { BlogHeader } from "../../components/blog-header";

import AmbientGlow from "../../components/ambient-glow.astro";
import SoftSeam from "../../components/soft-seam.astro";

import DesignWorkflowsVisually from "../../sections/design-workflows-visually.astro";
import ZeroToProd from "../../sections/zero-to-prod.astro";
import Portability from "../../sections/portability.astro";
import Performance from "../../sections/performance.astro";
import Extensibility from "../../sections/extensibility.astro";
import Theming from "../../sections/theming.astro";
import ProcessCombination from "../../sections/process-combination.astro";
import Storage from "../../sections/storage.astro";
import Reading from "../../sections/reading.astro";
import FlowPilot from "../../sections/flowpilot.astro";
import Integrations from "../../sections/integrations.astro";
import UseCases from "../../sections/use-cases.astro";
import TwentyFourHourBanner from "../../sections/24-hour-solution-banner.astro";
import EnterpriseStack from "../../sections/enterprise-stack.astro";
import ProblemSolution from "../../sections/problem-solution.astro";
import TargetAudience from "../../sections/target-audience.astro";
import CtaAutomate from "../../sections/cta-automate.astro";
import FAQ from "../../sections/faq.astro";
import Newsletter from "../../sections/newsletter.astro";
import { BlogFooter } from "../../components/blog-footer";

import Hero from "../../sections/hero.astro";
import { translations, languages } from "../../i18n";

const lang = "zh";
const t = translations[lang];

// --- SEO constants ---
const site = "https://flow-like.com";
const title = t["meta.title"];
const description = t["meta.description"];
const keywords = [
  "企业自动化","工作流自动化","本地部署自动化","可审计工作流",
  "可视化编程","类型化工作流","Rust","合规","治理","安全自动化"
].join(", ");
const appName = "Flow-Like";
const orgName = "TM9657 GmbH";
const canonicalUrl = `${site}/zh`;
const ogImage = `${site}/og.png`;
const ogImageAlt = "Flow-Like — 全面掌控的企业自动化";
const twitterCard = "summary_large_image";

const github = "https://github.com/TM9657/flow-like";
const docs = "https://docs.flow-like.com";
const download = "https://github.com/TM9657/flow-like/releases";
const enterpriseContact = "mailto:enterprise@flow-like.com?subject=Risk%20Review%20请求";

// --- JSON-LD blocks ---
const ldOrganization = {
  "@context": "https://schema.org",
  "@type": "Organization",
  name: orgName,
  url: site,
  logo: `${site}/favicon.svg`,
  sameAs: [github, docs]
};

const ldSoftware = {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  name: appName,
  applicationCategory: "DeveloperApplication",
  applicationSubCategory: "Workflow automation",
  operatingSystem: "macOS, Windows, Linux",
  url: site,
  downloadUrl: download,
  image: ogImage,
  description,
  license: `${github}/blob/main/LICENSE`
};

const ldWebSite = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  name: appName,
  url: site,
  publisher: { "@type": "Organization", name: orgName },
  inLanguage: "zh"
};

const ldWebPage = {
  "@context": "https://schema.org",
  "@type": "WebPage",
  url: canonicalUrl,
  name: title,
  description,
  isPartOf: { "@type": "WebSite", url: site, name: appName },
  inLanguage: "zh"
};

const alternateLinks = [
  { hreflang: "en", href: site },
  { hreflang: "de", href: `${site}/de` },
  { hreflang: "es", href: `${site}/es` },
  { hreflang: "fr", href: `${site}/fr` },
  { hreflang: "zh", href: `${site}/zh` },
  { hreflang: "ja", href: `${site}/ja` },
  { hreflang: "ko", href: `${site}/ko` },
  { hreflang: "pt", href: `${site}/pt` },
  { hreflang: "it", href: `${site}/it` },
  { hreflang: "nl", href: `${site}/nl` },
  { hreflang: "sv", href: `${site}/sv` },
  { hreflang: "x-default", href: site }
];
---

<!doctype html>
<html lang={lang} class="scroll-smooth max-w-full overflow-x-hidden" style="overflow-x: hidden;">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>{title}</title>
    <meta name="description" content={description} />
    <meta name="keywords" content={keywords} />
    <meta name="application-name" content={appName} />
    <meta name="robots" content="index,follow" />
    <meta name="generator" content={Astro.generator} />

    <link rel="canonical" href={canonicalUrl} />
    {alternateLinks.map(alt => (
      <link rel="alternate" hreflang={alt.hreflang} href={alt.href} />
    ))}
    <link rel="alternate" type="application/rss+xml" title="Flow-Like Blog" href="/rss.xml" />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)" />
    <meta name="theme-color" content="#0b0f19" media="(prefers-color-scheme: dark)" />

    <meta property="og:type" content="website" />
    <meta property="og:site_name" content={appName} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:image" content={ogImage} />
    <meta property="og:locale" content="zh_CN" />

    <meta name="twitter:card" content={twitterCard} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImage} />

    <script type="application/ld+json">{JSON.stringify(ldOrganization)}</script>
    <script type="application/ld+json">{JSON.stringify(ldSoftware)}</script>
    <script type="application/ld+json">{JSON.stringify(ldWebSite)}</script>
    <script type="application/ld+json">{JSON.stringify(ldWebPage)}</script>

    <style is:global>
      body {
        background-image: radial-gradient(
          color-mix(in srgb, var(--muted) 20%, transparent) 1px,
          transparent 1px
        ) !important;
        background-size: 16px 16px !important;
        background-attachment: scroll !important;
      }
      html, body { overflow-x: clip; }
      @media (hover: none) and (pointer: coarse) {
        [data-overlay], [data-visual], .overlay, .backdrop {
          pointer-events: none;
          touch-action: pan-y;
        }
        * { scroll-snap-type: none !important; }
        html { scroll-behavior: auto !important; }
        html, body, main, section, [role="region"] {
          overflow: visible !important;
        }
        .sticky, [style*="position: sticky"] { position: static !important; }
      }
      html, body { min-height: 100%; }
      html, body {
        overflow-y: auto;
        overflow-x: hidden !important;
        max-width: 100vw;
        -webkit-overflow-scrolling: touch;
        touch-action: pan-y;
      }
      :root, body, #content {
        overscroll-behavior: auto;
      }
    </style>
  </head>

  <body class="bg-background text-foreground antialiased selection:bg-primary/30 overflow-x-hidden max-w-full">
    <main id="content" class="w-full">
      <AmbientGlow />
      <BlogHeader client:load/>
      <Hero lang={lang} />

      <EnterpriseStack lang={lang} />
      <CtaAutomate lang={lang} />
      <ProblemSolution lang={lang} />
      <UseCases lang={lang} />
      <DesignWorkflowsVisually lang={lang} />
      <TargetAudience lang={lang} />
      <TwentyFourHourBanner lang={lang} />
      <Portability lang={lang} />
      <SoftSeam />
      <Performance lang={lang} />
      <FlowPilot lang={lang} />
      <Extensibility lang={lang} />
      <ZeroToProd lang={lang} />
      <Integrations lang={lang} />
      <SoftSeam />
      <Theming lang={lang} />
      <SoftSeam />
      <ProcessCombination lang={lang} />
      <SoftSeam />
      <Storage lang={lang} />
      <Reading lang={lang} />
      <Newsletter lang={lang} />
      <FAQ lang={lang} />
    </main>

    <BlogFooter />
  </body>
</html>
